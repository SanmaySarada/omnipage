---
phase: 09-interactive-features
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/slider.tsx
  - components/calculator/calculator-section.tsx
  - components/calculator/tuition-slider.tsx
  - components/calculator/spend-slider.tsx
  - components/calculator/calculator-results.tsx
  - components/calculator/index.ts
autonomous: true

must_haves:
  truths:
    - "User can drag tuition slider between $5k and $80k"
    - "User can type tuition amount directly in input field"
    - "User can drag everyday spend slider between $200 and $2,000/mo"
    - "User sees animated counters update as sliders move"
    - "User sees total points, dollar value, and tuition reduction percentage"
    - "User sees CTA button below calculator results"
  artifacts:
    - path: "components/ui/slider.tsx"
      provides: "shadcn Slider component with Radix accessibility"
    - path: "components/calculator/tuition-slider.tsx"
      provides: "Tuition slider with synced input field"
      exports: ["TuitionSlider"]
    - path: "components/calculator/spend-slider.tsx"
      provides: "Monthly spend slider with synced input field"
      exports: ["SpendSlider"]
    - path: "components/calculator/calculator-results.tsx"
      provides: "Animated results display using Odometer"
      exports: ["CalculatorResults"]
    - path: "components/calculator/calculator-section.tsx"
      provides: "Main calculator section wrapper"
      exports: ["CalculatorSection"]
  key_links:
    - from: "calculator-section.tsx"
      to: "tuition-slider.tsx, spend-slider.tsx, calculator-results.tsx"
      via: "state lifted to parent"
      pattern: "useState.*tuition.*monthlySpend"
    - from: "calculator-results.tsx"
      to: "components/how-you-earn/shared/odometer.tsx"
      via: "import reuse"
      pattern: "import.*Odometer.*from.*odometer"
    - from: "tuition-slider.tsx"
      to: "components/ui/slider.tsx"
      via: "Radix Slider primitive"
      pattern: "import.*Slider.*from.*@/components/ui/slider"
---

<objective>
Create the rewards calculator section with dual sliders (tuition and everyday spend), animated result counters, and waitlist CTA.

Purpose: CALC-01 through CALC-05 enable users to visualize their potential rewards, driving waitlist conversions by making value tangible.
Output: Working calculator section with accessible sliders, synced inputs, and animated odometer displays.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-interactive-features/09-RESEARCH.md

Key existing components to reuse:
@components/how-you-earn/shared/odometer.tsx (DollarOdometer, PointsOdometer, PercentOdometer)
@components/ui/input.tsx (for synced text input)
@components/ui/button.tsx (for CTA)
@lib/animation-variants.ts (slideUpVariants, staggerContainerVariants)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn Slider and create calculator components</name>
  <files>
    components/ui/slider.tsx
    components/calculator/tuition-slider.tsx
    components/calculator/spend-slider.tsx
    components/calculator/calculator-results.tsx
  </files>
  <action>
1. Install shadcn Slider component:
   ```bash
   npx shadcn@latest add slider
   ```

2. Create `components/calculator/tuition-slider.tsx`:
   - Props: `value: number`, `onChange: (value: number) => void`
   - Range: min=5000, max=80000, step=1000
   - Two-way binding between Slider and Input
   - Input uses `type="text" inputMode="numeric"` (NOT type="number" - see research pitfalls)
   - Format display as currency: `$25,000`
   - Parse input by stripping non-numeric chars
   - Clamp parsed value to min/max before setting state
   - Label: "Annual Tuition"
   - Input className includes `tabular-nums` for stable width

3. Create `components/calculator/spend-slider.tsx`:
   - Props: `value: number`, `onChange: (value: number) => void`
   - Range: min=200, max=2000, step=50
   - Same two-way binding pattern as TuitionSlider
   - Format display as currency with /mo suffix: `$500/mo`
   - Label: "Monthly Everyday Spend"
   - Input className includes `tabular-nums`

4. Create `components/calculator/calculator-results.tsx`:
   - Props: `tuition: number`, `monthlySpend: number`
   - Import existing odometers: `DollarOdometer`, `PointsOdometer`, `PercentOdometer` from `@/components/how-you-earn/shared/odometer`
   - Calculate rewards using useMemo:
     - tuitionPoints = tuition * 0.01 * 100 (1% back as points)
     - spendPoints = monthlySpend * 12 * 0.05 * 100 (5% avg merchant multiplier)
     - totalPoints = tuitionPoints + spendPoints
     - dollarValue = totalPoints * 0.01 (1 point = $0.01)
     - tuitionReduction = (dollarValue / tuition) * 100
   - Display in 3-column grid:
     - PointsOdometer for total points
     - DollarOdometer for dollar value
     - PercentOdometer for tuition reduction
   - Each result has label below: "Total Points", "Dollar Value", "Tuition Reduction"
   - Use font-display on odometer values for premium feel
  </action>
  <verify>
    - `ls components/ui/slider.tsx` exists
    - `ls components/calculator/tuition-slider.tsx` exists
    - `ls components/calculator/spend-slider.tsx` exists
    - `ls components/calculator/calculator-results.tsx` exists
    - Files compile without TypeScript errors: `npx tsc --noEmit`
  </verify>
  <done>
    - shadcn Slider installed
    - TuitionSlider renders with $5k-$80k range, synced input
    - SpendSlider renders with $200-$2k range, synced input
    - CalculatorResults displays 3 animated odometers
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CalculatorSection wrapper with CTA</name>
  <files>
    components/calculator/calculator-section.tsx
    components/calculator/index.ts
  </files>
  <action>
1. Create `components/calculator/calculator-section.tsx`:
   - 'use client' directive (has state)
   - State: `const [tuition, setTuition] = useState(25000)`
   - State: `const [monthlySpend, setMonthlySpend] = useState(500)`
   - Wrap in section with id="calculator"
   - Use ScrollReveal for headline animation
   - Headline: "Calculate Your Rewards" (font-display)
   - Subhead: "See how much you could earn with Omni"
   - Layout: max-w-4xl mx-auto px-4 py-20 sm:py-24 (matches other sections)
   - Sliders section: grid grid-cols-1 md:grid-cols-2 gap-8
   - Results section: mt-12 with CalculatorResults
   - CTA section: mt-12 text-center
     - Use EmailCapture component (import from @/components/hero/email-capture)
     - Text above: "Ready to start earning?"
   - Pass state down to child components

2. Create `components/calculator/index.ts` barrel export:
   ```typescript
   export { CalculatorSection } from './calculator-section'
   ```

3. Styling notes:
   - Background: bg-gradient-to-b from-background to-muted/30 (subtle)
   - Card wrapper around sliders: bg-card rounded-lg p-8 shadow-sm border
   - Results card: bg-primary/5 rounded-lg p-8 for highlight
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Import works: add temporary test import in a file
  </verify>
  <done>
    - CalculatorSection renders with headline, sliders, results, CTA
    - State flows correctly between parent and children
    - Barrel export enables `import { CalculatorSection } from '@/components/calculator'`
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify calculator interaction works correctly</name>
  <files>None (verification only)</files>
  <action>
1. Start dev server: `npm run dev`

2. Temporarily add CalculatorSection to page.tsx for testing:
   - Import: `import { CalculatorSection } from '@/components/calculator'`
   - Replace calculator placeholder with `<CalculatorSection />`

3. Test in browser at http://localhost:3000:
   - Drag tuition slider - verify range $5k to $80k
   - Type in tuition input - verify clamping and formatting
   - Drag spend slider - verify range $200 to $2k
   - Type in spend input - verify clamping and formatting
   - Watch odometer counters animate when values change
   - Verify all three results update (points, dollars, percentage)
   - Verify CTA button is visible below results

4. Check accessibility:
   - Tab through sliders and inputs
   - Verify focus states visible
   - Slider should be keyboard operable (arrow keys)

5. Revert the temporary page.tsx change (Plan 3 does final integration)
  </action>
  <verify>
    - Tuition slider works: drag and type
    - Spend slider works: drag and type
    - Odometers animate smoothly
    - Results update in real-time
    - CTA is visible and accessible
  </verify>
  <done>
    - Calculator is fully interactive
    - Sliders sync with inputs bidirectionally
    - Animated counters work
    - CTA is present for waitlist conversion
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build` passes without errors
2. `npx tsc --noEmit` passes
3. Calculator section is ready for page integration (Plan 3)
4. CALC-01, CALC-02, CALC-03, CALC-04, CALC-05 requirements addressed
</verification>

<success_criteria>
- User can drag tuition slider ($5k-$80k) or type amount directly
- User can drag everyday spend slider ($200-$2,000/mo)
- User sees odometer-style animated counters update as sliders move
- User sees total points, dollar value, and effective tuition reduction %
- CTA button below calculator connects to waitlist
</success_criteria>

<output>
After completion, create `.planning/phases/09-interactive-features/09-01-SUMMARY.md`
</output>
